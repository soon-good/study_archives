# μ°Έκ³ μλ£

- [μ—λΌμ¤ν‹± μ„μΉ μ‹¤λ¬΄κ°€μ΄λ“](http://www.yes24.com/Product/Goods/71893929?OzSrank=1)

# λ§¤ν•‘ νλΌλ―Έν„°

λ¨λ“  λ‚΄μ©λ“¤μ„ λ‹¤λ£¨κΈ°μ—λ” μ΅°κΈ λ¬Έμ„κ°€ κΈΈμ–΄μ§€μ§€ μ•μ„κΉ μ‹¶λ‹¤. μ—¬κΈ°μ„λ” μ£Όμ”ν•κ² μ‚¬μ©λλ” νλΌλ―Έν„°λ“¤λ§μ„ μ •λ¦¬ν•΄λ†“μΌλ ¤ ν•λ‹¤. λ°”λ΅ [μ΄μ „ λ¬Έμ„](https://gosgjung.gitbook.io/lognomy/lognomy/elastic-cloud/undefined/index-mapping-overview)μ— μ‚΄ν΄λ³Έ μμ μ—μ„λ” μ•„λμ μΈλ±μ¤ λ§¤ν•‘(DDL) κµ¬λ¬Έμ„ ν†µν•΄ μΈλ±μ¤μ μƒμ„±κ³Ό λ™μ‹μ— νƒ€μ…λ§¤ν•‘μ„ ν•΄μ£Όμ—μ—λ‹¤.

```bash
PUT financial_yearly 
{
  "mappings":{
    "properties":{
      "stockCode": {
        "type": "keyword"
      },
      "stockName": {
        "type": "text",
        "analyzer": "standard"
      },
      "fundamental": {
        "properties": {
          "baseDate": {
            "type": "date",
            "format": "yyyy-MM-dd'T'HH:mm:ss||yyyy-MM-dd||epoch_millis||yyyyMMdd"
          },
          "pbr":{
            "type": "double"
          },
          "per":{
            "type": "double"
          }
        }
      }
    }
  }
}
```

stockName ν•„λ“λ¥Ό μμ„Έν λ³΄μ. μ•„λμ™€ κ°™μ΄ μ •μν–μ—λ‹¤. stockName μ— λ€ν•΄μ„ object ν•μ‹μΌλ΅ λ°μ΄ν„°λ¥Ό μ •μν•λ”λ° "type" μ™Έμ— "analyzer" λΌλ” ν•­λ©μ΄ ν•λ‚ λ³΄μΈλ‹¤. κ·Έλ¦¬κ³  analyzer λ” "standard" λΌλ” κ°’μ„ κ°–λ” ν•λ‚μ ν‚¤/κ°’ μμ΄λ‹¤.

```bash
PUT financial_yearly 
{
  "mappings":{
    // ...
      "stockName": {
        "type": "text",
        "analyzer": "standard"
      },
    // ...
    }
  }
}
```

μ΄ analyzer λΌλ” ν•­λ©μ€ μ—λΌμ¤ν‹± μ„μΉμ—μ„ "**λ§¤ν•‘ νλΌλ―Έν„°**" λΌλ” μ©μ–΄λ΅ λ¶€λ¥Έλ‹¤. κΈ°μ–µν•΄λ‘μ. μ΄λ° `λ§¤ν•‘ νλΌλ―Έν„°` μ μΆ…λ¥λ“¤μ„ μΆ…λ¥λ³„λ΅ ν•„μ”ν• κ²ƒλ§ μ”μ λ§ κ°„λ‹¨ν μ •λ¦¬ν•΄λ³Ό μƒκ°μ΄λ‹¤. κΉμ΄ μλ” λ‚΄μ©μ€ μ±…μ—μ„ μ°Ύμ•„λ³΄λ„λ΅ ν•μ.  

# analyzer

> text νƒ€μ…μ ν•„λ“λ” analyzer λ§¤ν•‘ νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•΄μ•Ό ν•λ©°, λ„λ½ν–μ„ κ²½μ° ν•΄λ‹Ή ν•„λ“λ” "standard" λ¶„μ„κΈ°(analyzer)λ΅ μ„Έν…λλ‹¤.  

analyzer κ°€ μ μ©λκ±°λ‚, λ…μ‹λ ν•„λ“λ”  ν•΄λ‹Ή ν•„λ“κ°€ ν•νƒμ† λ¶„μ„μ λ€μƒμ΄ λλ‹¤. μƒ‰μΈ(insert), κ²€μƒ‰μ‹ λ§¤ν•‘μ‹ μ§€μ •ν• λ¶„μ„κΈ°(analyzer)λ΅ ν•νƒμ† λ¶„μ„μ΄ μ΄λ¤„μ§„λ‹¤. λ¶„μ„κΈ°(analyzer)μ μΆ…λ¥λ” μ—¬λ¬κ°€μ§€κ°€ μλ”λ° μ„μ—μ„λ” "standard" λ¥Ό μ§€μ •ν–λ‹¤. 

# normalizer

> μλ¥Ό λ“¤μ–΄ keyword νƒ€μ…μ ν•„λ“μ— μ‚¬μ©ν•  μ μλ” ν•νƒμ† λ¶„μ„κΈ°(analyzer)λ” normalizer μ΄λ‹¤. keyword νƒ€μ…μ ν•„λ“μ— λ€ν•΄ standard νƒ€μ…μ λ¶„μ„κΈ°(analyzer)λ¥Ό μ‚¬μ©ν•   κ²½μ° μ—λ¬λ¥Ό λ‚Έλ‹¤. ([μ°Έκ³  - keyword νƒ€μ…μ— λ€ν•΄ standard analyzer λ¥Ό μ‚¬μ©ν•λ ¤ ν•  λ• μ—λ¬κ°€ λ‚λ” μ΄μ  - discuss.elastic.co](https://discuss.elastic.co/t/mapping-definition-for-fields-has-unsupported-parameters-analyzer-not-standard/204782))

λ§¤ν•‘ νλΌλ―Έν„° `normalizer` λ” term query μ— λ¶„μ„κΈ°λ¥Ό μ‚¬μ©ν•κΈ° μ„ν•΄ μ‚¬μ©λλ‹¤. μλ¥Ό λ“¤μ–΄ keyword νƒ€μ…μ ν•„λ“λ¥Ό ν•νƒμ†λ¶„μ„ν•λ ¤κ³  ν•  κ²½μ° 'Kospi', 'KOSPI', kOSpi' λ” λ¨λ‘ λ‹¤λ¥Έ λ¬Έμλ΅ μΈμ‹λλ‹¤. λ§¤ν•‘μ‹ λ§¤ν•‘ νλΌλ―Έν„°λ΅ normalizer λ¥Ό asciifolding μΌλ΅ μ§€μ •ν•λ©΄ 'Kospi', 'KOSPI', 'kOSpi' λ” κ°™μ€ λ¬Έμμ—΄λ΅ μΈμ‹λ  μ μκ² λλ‹¤.  

ex)

```bash
PUT financial_yearly 
{
  "mappings":{
    // ...
      "stockCode": {
        "type": "keyword",
        "normalizer": "asciifolding"
      },
    // ...
    }
  }
}
```



# boost

μµμ‹  λ²„μ „μ μ—λΌμ¤ν‹± μ„μΉλ” μƒ‰μΈμ‹ boost μ„¤μ •μ„ ν•  μ μ—†λ„λ΅ λ°”λ€μ—λ‹¤. λ‚΄λ¶€μ μΌλ΅ μ‚¬μ©ν•λ” λ£¨μ”¬μ—μ„ κΈ°λ¥μ΄ μ κ±°λμ–΄μ„ λΌκ³  ν•λ‹¤. ( [μ°Έκ³ ](https://stackoverflow.com/questions/45822066/index-time-field-level-boosting-in-lucene-6-6-0) )

# coerce

μƒ‰μΈ(INSERT) μ‹ μλ™ λ³€ν™μ„ ν—μ©ν• μ§€ μ—¬λ¶€λ¥Ό μ„¤μ •ν•λ” νλΌλ―Έν„°μ΄λ‹¤. μ„μ—μ„ μƒμ„±ν• λ§¤ν•‘ κµ¬λ¬Έμ„ μλ΅ λ“¤μ–΄λ³΄μ

```bash
PUT financial_yearly 
{
  "mappings":{
    "properties":{
      "stockCode": {
        "type": "keyword"
      },
      "stockName": {
        "type": "text",
        "analyzer": "standard"
      },
      "fundamental": {
        "properties": {
          "baseDate": {
            "type": "date",
            "format": "yyyy-MM-dd'T'HH:mm:ss||yyyy-MM-dd||epoch_millis||yyyyMMdd"
          },
          "pbr":{
            "type": "double"
          },
          "per":{
            "type": "double"
          }
        }
      }
    }
  }
}
```

`fundamental.pbr` ν•„λ“μ κ²½μ° `double` νƒ€μ…μΌλ΅ μ§€μ •λμ–΄ μλ‹¤. μ΄ ν•„λ“μ— "100.00" λ°μ΄ν„°κ°€ λ“¤μ–΄μ™”μ„ λ• coerce μµμ…μ„ μ§€μ •ν• μΈλ±μ¤λΌλ©΄ "100.00" μ„ 100.00 μΌλ΅ μλ™μΌλ΅ ν•λ³€ν™ν•μ—¬ μ €μ¥ν•΄μ¤€λ‹¤.  

# copy_to

μƒλµ.

# fielddata

> fielddata λ” μ—λΌμ¤ν‹±μ„μΉκ°€ ν™ κ³µκ°„μ— μƒμ„±ν•λ” **λ©”λ¨λ¦¬ μΊμ‹**λ‹¤. λ©”λ¨λ¦¬ λ¶€μ΅± λ° μ¦μ€ GC κ΄€λ ¨ μ΄μλ΅ μΈν•΄ ν„μ¬λ” κ±°μ μ‚¬μ©λμ§€ μ•κ³ , text νƒ€μ…μ ν•„λ“μ— λ€ν•΄μ„ μ •λ§ ν•„μ”ν• κ²½μ°μ— ν•ν•΄ μ‚¬μ©ν•λ” νΈμ΄λ‹¤. μµμ‹  μ—λΌμ¤ν‹± μ„μΉ λ²„μ „μ—μ„λ” **doc_values** λΌλ” μΊμ‹λ¥Ό μ‚¬μ©ν•λ‹¤. 

text νƒ€μ…μ ν•„λ“λ κΈ°λ³Έμ μΌλ΅ λ¶„μ„κΈ°μ— μν•΄ ν•νƒμ† λ¶„μ„μ΄ μ΄λ£¨μ–΄μ§„λ‹¤. λ”°λΌμ„ μ§‘κ³„λ‚ μ •λ ¬ λ“±μ κΈ°λ¥μ„ μν–‰ν•  μ μ—†λ‹¤. ν•μ§€λ§ κ°„νΉ text νƒ€μ…μ ν•„λ“μ— λ€ν•΄ μ§‘κ³„, μ •λ ¬μ„ μν–‰ν•λ” κ²½μ° μ—­μ‹ μ΅΄μ¬ν•  μ μλ‹¤. μ΄λ° κ²½μ°μ— ν•ν•΄ fielddata λ¥Ό μ‚¬μ©ν•  μ μλ‹¤.(ν•μ§€λ§, fielddata λ” λ©”λ¨λ¦¬μ— μƒμ„±λλ” μΊμ‹μ΄κΈ° λ•λ¬Έμ— μµμ†ν•μΌλ΅ μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.)

μ‚¬μ© μμ )

```bash
PUT financial_yearly 
{
  "mappings":{
    // ...
      "stockName": {
        "type": "text",
        "fielddata": true,
        "normalizer": "asciifolding"
      },
    // ...
    }
  }
}
```

# doc_values

μ—λΌμ¤ν‹± μ„μΉμ—μ„ μ‚¬μ©ν•λ” κΈ°λ³Έ μΊμ‹μ΄λ‹¤. text νƒ€μ… μ™Έμ κ±°μ λ¨λ“  νƒ€μ…μ—μ„ `doc_values` μΊμ‹λ¥Ό μ‚¬μ©ν•λ‹¤. `doc_values` λ” λ£¨μ”¬ λ² μ΄μ¤μ μΊμ‹ λ°©μ‹μ΄λ‹¤. μ •λ ¬/μ§‘κ³„κ°€ ν•„μ”μ—†λ” ν•„λ“μ κ²½μ° `doc_values` μµμ…μ„ λΉ„ν™μ„±ν™”ν•λ” κ²ƒμ΄ κ¶μ¥λλ‹¤. (ν•λ² λΉ„ν™μ„±ν™”λ ν•„λ“λ” μΈλ±μ¤λ¥Ό μ¬μƒ‰μΈ ν•μ§€ μ•λ” ν• λ³€κ²½μ΄ λ¶κ°€λ¥ν•λ‹¤.)  β€

κµ¬μ΅°μ μΌλ΅λ” OS μ νμΌμ‹μ¤ν…μ μΊμ‹λ¥Ό ν†µν•΄ λ””μ¤ν¬ λ‚΄μ λ°μ΄ν„°μ— λΉ λ¥΄κ² μ ‘κ·Όν•λ‹¤. κ³Όκ±°μ—λ” μΊμ‹λ¥Ό λ¨λ‘ λ©”λ¨λ¦¬μ— μ¬λ ¤μ„ μ‚¬μ©ν–λ”λ°, μ„μ—μ„ μ‚΄ν΄λ΄¤λ“―μ΄ GC, ν™ λ©”λ¨λ¦¬ λ¶€μ΅± ν„μƒλ“±μ„ μ•ΌκΈ°ν–λ‹¤κ³  ν•λ‹¤. ν„μ¬λ” `doc_values` λ¥Ό μ‚¬μ©ν•¨μΌλ΅μ¨ λ©”λ¨λ¦¬ λ¶€λ‹΄μ„ μ¤„μ€λ‹¤. (λ²„μ „μ΄ μ¬λΌκ°€λ©΄μ„, μ•μΌλ΅ λ μ–΄λ–»κ² λ³€ν• μ§€λ” μ‚΄ν΄λ΄μ•Ό ν•  μΌμΈκ²ƒ κ°™λ‹¤λ” μƒκ°μ΄ λ“ λ‹¤. 6.x λ²„μ „μ— μ΅΄μ¬ν•λ” type κ°λ…μ„ μ—†μ•¤κ²ƒλ§ λ³΄λ”λΌλ„, μ–Έμ  κ°€λ” μ—†μ• λ” κ°λ…λ“¤μ΄ μμ§€ μ•μ„κΉ? ν•λ” λ‘λ ¤μ›€μ΄ μ΅°κΈμ€ λ“ λ‹¤...)  

# format

μ‹κ°„/λ‚ μ§λ¥Ό λ§¤ν•‘ν•  λ• format νλΌλ―Έν„°λ¥Ό μ‚¬μ©ν•λ‹¤. μ΄ format νƒ€μ…μ— λ€ν•΄μ„λ” μ•„λμ λ§ν¬λ¥Ό ν™•μΈν•μ. (λ‚μ¤‘μ— μ •λ¦¬ν• ...μμ •μ΄λ‹¤ π…)

[Elasticsearch Reference [7.10] > Mapping > Mapping parameters > format](https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-date-format.html)

# index

λ§¤ν•‘ νλΌλ―Έν„° `index`  λ” ν•„λ“ κ°’μ„ μƒ‰μΈν•  μ§€λ¥Ό κ²°μ •ν•λ‹¤. μΈλ±μ¤ λ§¤ν•‘μ‹ νλΌλ―Έν„°λ΅ λ…μ‹μ μΌλ΅ μ§€μ •ν•μ§€ μ•μΌλ©΄ μλ™μΌλ΅ true λ΅ μ„Έν…λλ‹¤. λ§¤ν•‘μ‹ λ…μ‹μ μΌλ΅ falseλ΅ μ„Έν…ν•λ©΄ ν•„λ“λ¥Ό μƒ‰μΈν•μ§€ μ•κ² λλ‹¤.  

# fieldsβ€

λ‚λ„ μ΄κ² μ§€κΈμ€ λ­”μ§€ μ λ¨λ¥΄κ² μ§€λ§, λ‚μ¤‘μ— ν•„μ”ν•  κ²ƒ κ°™μ•„μ„ μ •λ¦¬ν•΄λ†“λ”λ‹¤. `fields` μµμ…μ€ ν•„λ“ μ•μ— λ λ‹¤λ¥Έ ν•„λ“μ μ •λ³΄λ¥Ό μ¶”κ°€ν•  μ μ‡κΈ° λ•λ¬Έμ— κ°™μ€ `fields` λ΅ μ„ μ–Έν• ν•„λ“λ” μ „ν€ λ‹¤λ¥Έ ν•„λ“λ΅ μ·¨κΈ‰ν•μ—¬ λ¶„μ„κΈ°κ°€ μ²λ¦¬ν•κ²λ” ν•  μ μλ‹¤.  

# norms (normalize, μ •κ·ν™”)

document(λ¬Έμ„)μ `_score` κ°’ κ³„μ‚°μ— ν•„μ”ν• μ •κ·ν™” μΈμλ¥Ό μ‚¬μ©ν• μ§€ μ—¬λ¶€λ¥Ό κ²°μ •ν•λ‹¤. μ•„λ¬΄ κ°’λ„ μ§€μ •ν•μ§€ μ•κ³  λ§¤ν•‘ν–μ„ λ• λ¬µμ‹μ μΌλ΅ norms νλΌλ―Έν„°λ” true λ΅ μ§€μ •λλ‹¤. `_score` κ³„μ‚°μ΄ ν•„μ”μ—†κ±°λ‚ λ‹¨μ ν•„ν„°λ§ μ©λ„λ΅ μ‚¬μ©ν•  κ²½μ°λ” λΉ„ν™μ„±ν™”ν•΄μ„ λ””μ¤ν¬ κ³µκ°„μ„ μ μ•½ν•  μ μλ‹¤.  

# null_valueβ€

μƒ‰μΈ μ‹ document(λ¬Έμ„)μ— ν•„λ“κ°€ μ—†κ±°λ‚ ν•„λ“μ κ°’μ΄ null μΌ κ²½μ° λ³΄ν†µμ€ ν•„λ“κ°€ μƒμ„±λμ§€ μ•λ”λ‹¤. ν•μ§€λ§ λ§μ•½ λ§¤ν•‘μ‹μ— null_valueλ¥Ό μ„Έν…ν•΄λ‘λ©΄ document λ‚΄μ ν•΄λ‹Ή ν•„λ“μ κ°’μ΄ null μ΄λ”λΌλ„ ν•΄λ‹Ή κΈ°λ³Έκ°’μΌλ΅ λ°μ΄ν„°λ¥Ό μ„Έν…ν•λ‹¤.  

ex)

```bash
PUT financial_yearly 
{
  "mappings":{
    // ...
      "per": {
        "type": "double",
        "null_value": "0"
      },
    // ...
    }
  }
}
```

κ°μΈμ μΈ μ‚¬κ²¬μΌλ΅λ”... null_valueλ¥Ό μ‚¬μ©ν•κΈ° μ „μ— μ•μ„μ„... μ«μν• λ°μ΄ν„°μ κ²½μ° ν•„λ“λ¥Ό ν•λ‚ λ” λ‘μ–΄μ„ μ„ νƒλ ν•λ‚μ λ„νλ¨ΌνΈμ— λ€ν•΄μ„ ν•΄λ‹Ή ν•„λ“κ°€ null μΈμ§€ μ—¬λ¶€λ¥Ό κ°€λ¦¬ν‚¤λ” ν•„λ“λ¥Ό λ§¤ν•‘μ‹ μ¶”κ°€ν•΄λ†“κ³  μ‚¬μ©ν•λ©΄ μƒκ΄€μ„±λ¶„μ„κ³Ό κ°™μ€ λ¶„μ„λ΅μ§μ„ μ§¤λ• μ΅°κΈμ€ μ μ©ν•΄μ§€μ§€ μ•μ„κΉ ν•λ” μƒκ°μ΄ λ“ λ‹¤.  

# properties

Object λλ” μ¤‘μ²© κµ¬μ΅°μ λ°μ΄ν„°λ¥Ό μ‘μ„±ν•  λ• μ‚¬μ©λλ” μµμ…μ΄λ‹¤. ν•„λ“μ νƒ€μ…μ„ λ§¤ν•‘ν•λ” μ—­ν• μ„ ν•λ‹¤. Object/μ¤‘μ²© ν•„λ“λ” propertiesλΌλ” μ„λΈ ν•„λ“κ°€ μλ‹¤.  

# β€search_analyzer

νΉμ • ν•„λ“ ν•λ‚μ— λ€ν•΄μ„ νΉμν• λ¶„μ„κΈ°λ¥Ό μ‚¬μ©ν•λ ¤κ³  ν•λ‹¤λ©΄ search_analyzer νλΌλ―Έν„°λ¥Ό μ„¤μ •ν•λ” κ²ƒμΌλ΅ λ¶„μ„κΈ°λ¥Ό λ³„λ„ μ§€μ •ν•  μ μλ‹¤.  

# λ§λ¬΄μΌλ¦¬...β€

μ°λ¦¬λ” MySQL, Oracle μ„ λ°°μ°λ©΄μ„ DDL μ‘μ„±μ‹μ— ν•„μ”ν• μ»¬λΌ νƒ€μ…λ“¤μ„ μ™Έμ°κ³  λ‹¤λ‹μ§€ μ•μ•λ‹¤. λ€μ‹  μ„¤κ³„μ‹μ— κ³µμ‹λ¬Έμ„λ¥Ό κΌΌκΌΌν λ³΄κ³  μλ¦Ώμκ°€ μ–΄λ”§κΉμ§€μΈμ§€, μ΄ νƒ€μ…μ νΉλ³„ν• μ μ€ λ¬΄μ—‡μΈμ§€ λ“±μ„ κΌΌκΌΌν λ”°μ Έλ³΄κ³  μ„Έν…ν•λ” νΈμ΄μ—λ‹¤. Elastic Searchμ λ§¤ν•‘ νλΌλ―Έν„°λ¥Ό μ •λ¦¬ν•λ” κ³Όμ •μ€ DDLμ‹μ μ»¬λΌ νƒ€μ…μ„ μ •λ¦¬ν•λ” κ²ƒκ³Ό μ μ‚¬ν• μ‘μ—…μ΄λΌκ³  λκΌλ‹¤. κ·Έλμ„ μ΄κ±Έ κ³„μ† μ •λ¦¬ν•λ”κ² λ§μ„κΉ? ν•λ” μƒκ°μ΄ μμ£Ό λ“¤μ—μ—λ‹¤.  

ν•μ§€λ§, Elastic Search λ¥Ό μ λ€λ΅ μ±…μ„ λ³΄κ³  κ³µλ¶€ν•λ©΄μ„ λ¨λ‘ μ •λ¦¬ν•΄λ³΄λ©΄μ„ λλ‚€ μ μ€ Elastic Searchλ” κΈ°μ΅΄μ λ°μ΄ν„°λ² μ΄μ¤μ™€λ” λ‹¤λ¥Έ μ λ“¤μ΄ λ§λ‹¤λ” μ μ΄μ—λ‹¤. κ·Έλ¦¬κ³  μ¶”κ°€λ΅ λλ‚€ μ μ€ λ­”κ°€λ¥Ό μ‚¬μ†ν•κ² κΌΌκΌΌν κ³µλ¶€ν•λ” κ²ƒκ³Ό λ„κ²¨μ§μ–΄μ„ λ‚μ¤‘μ— μ°Ύμ•„λ³΄λ©΄ λμ§€ ν•λ” κ²ƒκ³Όλ” μ‹κ°„κ³Ό κ³µκ°„μ μ°¨μ΄κ°€ ν¬λ‹¤λ” μ μ΄μ—λ‹¤.  